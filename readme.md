# A&T用スライドショー、動画繋ぎのプログラム

これはA＆Tの動画作成班になったのは良いが、~~工房のパソコンがクソ~~私が手作業大嫌いだったために作ったプログラムのReadme.md。２、3日で作ったから所々ガバガバなのは優秀な後輩がきっと直してくれる。

面倒なことはすべてPythonにやらせよう。

- 2019-07-09 作成（渡邉）
- Written by Typora

## 背景

これ、読み飛ばして良いやつ。

タイトルの画像と作品の画像または動画を渡される。これをなんやかんやして、良い感じにA＆T開催中に表示しろと言われる。去年にやった先輩についていき、説明してもらった。三角コーンみたいな動画再生ソフトにプレイリストを作るらしい。手作業でひたすら素材を持ってくる。順番はlist.xlsxが渡された。エクセルのファイルだ。しかしながら、工房のパソコンにはエクセルはない。じゃあ持ち帰ってやれば良いじゃないか。去年の先輩もそう思ってやったが、出来上がったものを工房で再生しようとしてもうまく動かない。今年はそれはやらないで行こう。面倒だな。動画一つにしてやったらうまくいかないんすかね。よし、そうしよう。~~気づいたら全部私が作ることになってた~~。

  で、adobeに年貢を納めている私は素直に動画編集ソフトを使おうとした。でも待てよ、今先輩に引き継ぎされているということは、今度後輩に自分が引き継がなければいけないじゃないか。まあ、pythonならなんとかできるだろう。

  そんな感じで製作が始まった。

## ディレクトリ構成

- HOME
  - title
    - 自動作成されたらしいタイトル画像が入っている。全てpng形式。
  - works
    - 作品紹介の画像や動画が入っている。複数ある場合はディレクトリになっている。
  - tmp
    - 作業中の一時保存用ディレクトリ
  - combine_img_and_mov.py
    - Bxxx系のためのプログラム
  - make_slide_show.py
    - Cxxx系のためのプログラム
  - list.xlsx
    - 作品とか色々リストになってる。番号とかもふってある。

## 前提

- タイトル画像は全てpng形式になっている。
- 作品は３階層以下のディレクトリになっている。
  - `HOME/works/AT2019_C003/work1.png` つまりこのくらい深さまで
- ffmpegが導入済み
- sipsコマンドが使える

### その他 環境について

- Python3.7
- mac OSX 10.14.5（windowsは動作未確認）
- IDE:PyCharm

## ffmpeg

コマンドラインで動画をあれやこれやとしてくれる便利な奴。だいたいこいつを使って画像を動画にしたり、動画をつなげたりする。とっても良い奴なんだこいつ。

詳しくは[こちら](https://ffmpeg.org)。

## sips

macに搭載されている画像加工のコマンド。切り抜きとか高さ合わせて拡大縮小したり便利な奴。とっても良い奴なんだこいつ。

これで作品たちのサイズを高さが1080になるようにしている。

使い方とかは[こちら](https://qiita.com/livlea/items/53b755e5067d4ebc5b43)。

## make_slide_show.py

### 効能

`TITLE_PATH`のものと`WORKS_PATH`を5秒ずつ表示するスライドショーの動画を作成する。

### 使い方

最初はディレクトリ等々を指定する。ソースコード5~7行目の変数をよしなにする。

- 五行目`HOME_PATH`にtitleとかworksのディレクトリがある親ディレクトリを指定する。

- 六行目`TITLE_PATH`にどのタイトル画像のパスを指定する。タイトルの**ディレクトリのパスを入れないこと**に注意。

- 七行目`WORKS_PATH`に作品の画像のパスを指定する。作品の**ディレクトリのパスを入れないこと**に注意。

そんで最後に`python3 make_slide_show.py`ってすれば良いんじゃないかな。

## combine_img_and_mov.py

### 効能

`TITLE_PATH`を5秒間の動画にしたものと`WORKS_PATH`の動画をつなげて一つの動画にする。

### 使い方

`make_slide_show.py`とほぼ同じ。

変数に画像の形式と動画の形式を入れておくようにしたから、足りないのがあればそこに追加してくれ。