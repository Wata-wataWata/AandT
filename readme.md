# A&T用スライドショー、動画繋ぎのプログラム

これはA＆Tの動画作成班になったのは良いが、~~工房のパソコンがクソ、~~私が手作業大嫌いだったために作ったプログラムのReadme.md。２、3日で作ったから所々ガバガバなのは優秀な後輩がきっと直してくれる。

面倒なことはすべてPythonにやらせよう。

- 2019-07-09 作成（渡邉）
- Written by Typora

## 背景

これ、読み飛ばして良いやつ。



タイトルの画像と作品の画像または動画を渡される。これをなんやかんやして、良い感じにA&T開催中に表示しろと言われる。去年にやった先輩についていき、説明してもらった。三角コーンみたいな動画再生ソフトにプレイリストを作るらしい。手作業でひたすら素材を持ってくる。順番はlist.xlsxが渡された。エクセルのファイルだ。しかしながら、工房のパソコンにはエクセルはない。じゃあ持ち帰ってやれば良いじゃないか。去年の先輩もそう思ってやったが、出来上がったものを工房で再生しようとしてもうまく動かない。今年はそれはやらないで行こう。面倒だな。動画一つにしてやったらうまくいかないんすかね。よし、そうしよう。

で、adobeに年貢を納めている私は素直に動画編集ソフトを使おうとした。でも待てよ、今先輩に引き継ぎされているということは、今度後輩に自分が引き継がなければいけないじゃないか。まあ、pythonならなんとかできるだろう。

製作が始まった。

## ディレクトリ構成

- HOME
  - title
    - 自動作成されたらしいタイトル画像が入っている。全てpng形式。
  - works
    - 作品紹介の画像や動画が入っている。複数ある場合はディレクトリになっている。
  - tmp
    - 作業中の一時保存用ディレクトリ
  - combine_img_and_mov.py
    - Bxxx系のためのプログラム
  - make_slide_show.py
    - Cxxx系のためのプログラム
  - list.xlsx
    - 作品とか色々リストになってる。番号とかもふってある。

## 前提

- タイトル画像は全てpng形式になっている。
- 作品は３階層以下のディレクトリになっている。
  - `works/AT2019_C003/work1.png` つまりこの深さ
- ffmpegが導入済み

### その他 環境について

- Python3.7
- mac OSX 10.14.5（windowsは動作未確認）
- IDE:PyCharm

## ffmpeg

コマンドラインで動画をあれやこれやとしてくれる便利な奴。だいたいこいつを使って画像を動画にしたり、動画をつなげたりする。とっても良い奴なんだこいつ。

## sips

macに搭載されている画像加工のコマンド。切り抜きとか高さ合わせて拡大縮小したり便利な奴。とっても良い奴なんだこいつ。

これで作品たちのサイズを高さが1080になるようにしている。

## make_slide_show.py

### 効能

`title/ATyyyy_Cxxx.png`のものと`works/ATyyyy_Cxxx.zzz`を5秒ずつ表示するスライドショーの動画を作成すると思う。

### 使い方

`python3 make_slide_show.py`ってすれば良いんじゃないかな。